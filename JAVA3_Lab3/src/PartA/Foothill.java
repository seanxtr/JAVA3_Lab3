package PartA;

import java.text.NumberFormat;
import java.util.Locale;

public class Foothill
{
   final static int MAT_SIZE = 3200;
   final static double SMALL_PCT = 0.1;
   final static double DEFAULT_VALUE = 0.0;
   
   // -------  proof of correctness --------------
   public static void main(String[] args) throws Exception
   {
      int r, randRow, randCol;
      long startTime, stopTime;
      double smallPercent;
      boolean valueInserted;
      NumberFormat tidy = NumberFormat.getInstance(Locale.US);
      tidy.setMaximumFractionDigits(4);

      // non-sparse matrices
      double[][] mat, matAns;

      // allocate matrices
      mat = new double[MAT_SIZE][MAT_SIZE];
      matAns = new double[MAT_SIZE][MAT_SIZE];
      
      // generate small% of non-default values bet 0 and 1
      smallPercent = MAT_SIZE * MAT_SIZE * SMALL_PCT;
      for (r = 0; r < smallPercent; r++)
      {
         valueInserted = false;
         
         while (!valueInserted){
            randRow = (int)(Math.random() * MAT_SIZE);
            randCol = (int)(Math.random() * MAT_SIZE);
            
            if (mat[randRow][randCol] == DEFAULT_VALUE){
               mat[randRow][randCol] = Math.random();
               valueInserted = true;
            }
         }
      }
    
      // 10x10 sub-matrix in lower right
      System.out.println("Orignial matrix:");
      matShow(mat, MAT_SIZE - 10, 10);
      System.out.println();
      
      startTime = System.nanoTime();
      matMult(mat, mat, matAns);
      stopTime = System.nanoTime();

      System.out.println("Result matrix after multiplication:");
      matShow(matAns, MAT_SIZE - 10, 10);
    
      System.out.println("\nSize = " + MAT_SIZE + " Mat. Mult. Elapsed Time: "
         + tidy.format( (stopTime - startTime) / 1e9)
         + " seconds.");
   }
   
   public static void matMult( double[][] matA,  double[][] matB, 
      double[][] matC){
      // check two matrixes has same number of rows
      if (matA.length != matB.length)
         return;
      
      // loop through each row in matrix A
      for(int i = 0; i < MAT_SIZE; i++){
         // loop through each column in matrix B
         for (int k = 0; k < MAT_SIZE; k++){
            // calculate the dot product between the two
            matC[i][k] = calcDotProduct(i,k, matA, matB);
         }
      }
   }
   
   private static double calcDotProduct(int row, int column, 
      double[][] matA, double[][] matB) {
      double sum = 0.0;
      
      // loop through each item in row of matrix A
      for(int i = 0; i < MAT_SIZE; i++){
         // calculate the dot product
         sum += matA[row][i] * matB[i][column];
      }
      return sum;
   }
   
   public static void matShow(double[][] matA, int start, int size){
// loop through each row
      for (int i = start; i < start + size; i++){
         // loop through each column
         for (int k = start; k < start + size; k++){
            // print out data value
            System.out.printf("%7.5s",matA[i][k]);
         }
         System.out.print('\n');
      }
   }
}

/**************** RUN **********************
Orignial matrix:
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.660
    0.0  0.188    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.897    0.0    0.0
  0.279    0.0    0.0    0.0  0.301    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0  0.232    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0  0.182    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0  0.366    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.817  0.582

Result matrix after multiplication:
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.540  0.384
    0.0  0.035    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0  0.070    0.0    0.0    0.0  0.184
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0  0.085    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0  0.299    0.0    0.0    0.0  0.475  0.338

Size = 11 Mat. Mult. Elapsed Time: 0 seconds.

Orignial matrix:
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0  0.438    0.0  0.966    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0  0.206    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.886    0.0    0.0
    0.0    0.0  0.300    0.0    0.0    0.0    0.0  0.501    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0  0.390    0.0    0.0    0.0    0.0  0.345    0.0    0.0  0.001

Result matrix after multiplication:
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0  0.265    0.0    0.0    0.0    0.0  0.444    0.0    0.0
    0.0    0.0  0.150    0.0    0.0    0.0    0.0  0.251    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0  4.796  0.171    0.0  0.377    0.0  4.247  0.306    0.0  1.508

Size = 12 Mat. Mult. Elapsed Time: 0.0001 seconds.

Orignial matrix:
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0  0.776    0.0    0.0    0.0    0.0    0.0    0.0
    0.0  0.862    0.0    0.0  0.263    0.0    0.0    0.0    0.0    0.0
  0.017    0.0    0.0  0.571    0.0    0.0    0.0    0.0    0.0    0.0
    0.0  0.448    0.0  0.787    0.0    0.0    0.0    0.0    0.0  0.791
    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.749    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0  0.793    0.0  0.097    0.0  0.014    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0  0.523    0.0    0.0    0.0    0.0    0.0
  0.957    0.0    0.0    0.0    0.0    0.0    0.0  0.688    0.0    0.0

Result matrix after multiplication:
    0.0    0.0  0.120    0.0  0.166    0.0    0.0    0.0  0.684  0.393
  0.013  0.486    0.0  0.443    0.0    0.0  0.798    0.0    0.0  0.400
    0.0  0.436    0.0  0.877    0.0    0.0    0.0    0.0    0.0  0.557
  0.009  0.483    0.0  0.326    0.0  0.655  0.794    0.0    0.0  0.529
  0.771  0.327    0.0  0.797    0.0    0.0  0.257  0.545  0.564  0.461
  0.560  0.594    0.0  0.072  0.077  0.011    0.0  0.132    0.0  0.888
  0.035    0.0    0.0    0.0    0.0  0.190    0.0    0.0    0.0    0.0
  0.135    0.0  0.527  0.671  0.469  0.485    0.0  0.011  0.612  0.218
  0.111  0.234  0.725  0.549  0.601  0.668    0.0    0.0    0.0  0.414
    0.0  0.546  0.271  0.066  0.021  0.010    0.0    0.0    0.0  0.708

Size = 50 Mat. Mult. Elapsed Time: 0.0008 seconds.

Orignial matrix:
    0.0    0.0  0.738    0.0    0.0  0.067    0.0    0.0    0.0  0.735
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0  0.971    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0  0.269    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
  0.805    0.0    0.0    0.0  0.350    0.0  0.188    0.0  0.241    0.0
    0.0    0.0    0.0  0.090    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0  0.948    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0

Result matrix after multiplication:
  0.054    0.0    0.0  1.054  0.023  0.532  0.633  0.137  0.028    0.0
  0.665  0.692  0.018  0.356  0.903  0.553  0.055  0.026  0.962    0.0
    0.0  0.621    0.0  0.078  0.302  0.111  0.325    0.0    0.0  0.277
  0.094  0.250  0.083  0.087    0.0  0.232  0.026    0.0    0.0  0.266
    0.0  1.264    0.0  0.165  0.821  0.083    0.0    0.0    0.0    0.0
  0.040  0.031  0.595  0.301    0.0  0.232    0.0  0.041  0.169  0.592
  0.051  0.045  0.080  0.006    0.0  0.151  0.249  0.745    0.0  0.014
    0.0    0.0  0.067  0.052    0.0  0.362  0.056  0.627    0.0  0.243
    0.0    0.0  0.442    0.0  0.284    0.0  0.255  0.882    0.0  0.458
    0.0    0.0    0.0    0.0  0.145  0.434    0.0  0.195    0.0    0.0

Size = 100 Mat. Mult. Elapsed Time: 0.0041 seconds.

Orignial matrix:
  0.942  0.851    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.169
    0.0    0.0    0.0    0.0  0.447  0.818    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.376    0.0
    0.0    0.0    0.0    0.0    0.0    0.0  0.175    0.0    0.0    0.0
  0.851    0.0  0.798    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.087
    0.0    0.0    0.0  0.674  0.868    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
  0.942    0.0    0.0    0.0  0.439    0.0    0.0    0.0  0.732    0.0

Result matrix after multiplication:
  1.505  1.212  1.444  0.349  0.999  1.084  0.796  0.040  1.118  1.834
  0.990    0.0  0.654    0.0    0.0    0.0  0.353  0.160  0.062    0.0
  0.222    0.0  0.288  1.530  1.376  0.988  0.153  0.016  1.983    0.0
  0.831  0.633  0.495  1.288  0.738  1.494  0.138  0.132  0.050  0.700
  0.038  0.406  0.597  0.297  1.223    0.0  1.083  0.617  1.510  1.301
  1.530  1.601  0.014  1.635  1.537  0.529  0.183    0.0  0.544  0.163
  0.082    0.0    0.0  1.734  0.038  1.616  0.378    0.0  0.395    0.0
  0.208  0.023  0.358  1.493  0.322  0.058  0.714  0.310  0.376  0.411
    0.0  0.407  0.007  1.219  0.120    0.0    0.0  1.475    0.0  1.180
  2.232  1.843  0.393  1.448  0.217  0.537  1.271  0.237  1.091  1.526

Size = 200 Mat. Mult. Elapsed Time: 0.0152 seconds.

Orignial matrix:
  0.264  0.081    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0  0.048  0.928    0.0  0.695    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0  0.812    0.0    0.0    0.0    0.0  0.414    0.0    0.0
    0.0    0.0  0.109    0.0    0.0    0.0    0.0    0.0    0.0  0.071
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0  0.427    0.0    0.0    0.0    0.0    0.0    0.0    0.0

Result matrix after multiplication:
  0.560  0.187  0.453  0.732  1.079  0.473  0.224  0.073  1.187  0.248
  0.364  0.946  0.729  0.565  1.966  0.519  0.173  0.970  1.621  1.583
  1.914  0.526  0.344  0.070  0.852  0.566  1.952  0.866  1.613  1.141
  1.561  0.765  0.132  0.593  1.099  0.110  0.770  1.861  1.170  0.046
  0.398  0.479  0.913  0.248  1.603  0.737  1.851  1.868  1.021  0.082
  0.954  0.240  0.471  1.900  0.664  1.251  0.624  2.091  1.568  1.286
  0.592  0.748  1.061    0.0  2.205  0.172  1.020  0.978  0.864  1.639
  0.475  0.043  0.373  0.156  1.246  1.156  0.862  0.481  1.171  1.430
  1.381    0.0  0.761  1.370  1.241  0.707    0.0  0.376  1.294  1.157
  0.995  1.771  2.065  1.187  0.262  1.440  2.193  1.948  2.713  1.130

Size = 400 Mat. Mult. Elapsed Time: 0.1238 seconds.

Orignial matrix:
    0.0    0.0  0.531    0.0    0.0    0.0    0.0    0.0    0.0  0.779
    0.0    0.0  0.366    0.0    0.0    0.0    0.0    0.0    0.0    0.0
  0.331    0.0    0.0  0.319    0.0    0.0    0.0    0.0    0.0    0.0
    0.0  0.149    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.532
    0.0    0.0    0.0    0.0    0.0  0.545    0.0    0.0    0.0    0.0
    0.0    0.0  0.643  0.449    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0  0.179  0.210    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.560
  0.520    0.0    0.0  0.643    0.0    0.0    0.0    0.0    0.0    0.0
  0.833    0.0    0.0    0.0    0.0    0.0    0.0  0.946    0.0    0.0

Result matrix after multiplication:
  1.799  0.849  1.780  1.938  0.875  1.311  1.405  1.622  0.960  1.655
  2.018  1.655  4.023  4.620  0.092  2.576  3.925  2.338  0.450  1.789
  0.807  3.808  3.066  2.028  1.094  1.559  3.943  0.452  0.728  4.521
  1.317  2.269  1.041  0.881  2.069  2.924  1.471  2.359  2.925  2.920
  2.339  4.103  3.552  3.266  3.665  1.309  2.805  1.020  0.930  1.707
  1.824  1.511  0.783  1.256  1.765  2.550  0.813  3.281  1.168  1.204
  0.949  0.687  0.558  2.796  1.301  1.118  1.362  0.823  1.372  2.300
  3.695  3.402  4.179  0.466  2.030  2.005  2.490  1.517  1.593  1.420
  0.782  1.861  2.410  3.463  0.803  1.883  2.079  3.778  1.368  2.764
  3.012  1.250  4.762  3.555  2.934  0.770  0.819  0.645  2.162  2.819

Size = 800 Mat. Mult. Elapsed Time: 3.9678 seconds.

Orignial matrix:
    0.0    0.0    0.0    0.0    0.0  0.666    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.670    0.0
    0.0  0.725    0.0    0.0    0.0    0.0    0.0    0.0  0.472    0.0
    0.0    0.0    0.0    0.0  0.349    0.0  0.067    0.0    0.0    0.0
  0.946    0.0    0.0  0.786    0.0    0.0  0.673  0.145    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0  0.515    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0  0.121    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0  0.978    0.0    0.0    0.0    0.0    0.0    0.0

Result matrix after multiplication:
  4.261  2.327  0.349  3.628  4.381  0.444  2.445  1.242  2.613  2.843
  4.583  2.029  4.576  4.504  1.896  4.626  1.378  4.634  2.710  3.019
  2.794  4.463  4.289  4.482  6.280  3.357  2.950  2.968  4.429  3.074
  1.550  1.338  2.973  4.265  3.364  2.893  2.925  2.594  0.932  3.567
  2.091  1.566  2.325  3.140  3.296  3.703  2.543  1.751  2.016  3.292
  2.058  2.196  2.976  2.988  3.896  3.300  2.361  3.326  0.826  1.664
  3.427  2.165  3.246  5.403  4.072  3.501  2.976  4.550  2.513  2.730
  4.175  3.758  2.567  4.326  1.803  1.770  1.623  0.558  2.589  2.744
  2.446  4.584  1.925  4.021  2.371  2.060  4.843  2.459  2.696  2.167
  5.135  1.918  1.744  5.338  4.772  2.159  3.541  4.014  2.091  3.408

Size = 1200 Mat. Mult. Elapsed Time: 21.9252 seconds.

Orignial matrix:
  0.288    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0  0.242    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.168    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.127    0.0  0.215
    0.0    0.0  0.836  0.099    0.0  0.904    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.521

Result matrix after multiplication:
  3.028  4.003  2.820  2.752  2.589  4.108  4.403  4.199  3.876  5.201
  4.158  3.519  3.416  4.397  6.482  6.457  3.897  3.908  5.014  5.826
  4.214  4.076  2.159  3.523  1.909  2.146  3.332  4.773  4.713  6.506
  6.357  2.441  2.291  4.844  2.873  3.833  3.234  3.752  5.486  3.643
  1.910  2.525  4.416  2.167  4.695  4.117  3.734  3.616  2.608  4.305
  4.139  6.664  4.871  3.159  2.511  1.546  3.817  2.181  7.634  3.475
  1.021  3.277  4.007  4.412  2.276  3.454  4.446  2.911  4.341  6.646
  3.655  4.638  1.032  2.221  2.722  3.480  3.514  2.744  2.619  2.802
  6.342  4.917  4.477  7.901  4.337  4.722  3.774  4.635  4.954  4.789
  2.701  5.632  5.495  5.509  3.582  5.113  2.761  7.203  5.215  8.134

Size = 1600 Mat. Mult. Elapsed Time: 60.1127 seconds.

Orignial matrix:
    0.0  0.454  0.445    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.344    0.0    0.0
    0.0  0.275    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0  0.906  0.798    0.0    0.0    0.0    0.0  0.676    0.0
  0.098    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.164    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
  0.780    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0
    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0

Result matrix after multiplication:
  6.374  8.035  7.936  10.08  10.97  9.299  5.526  7.748  6.744  7.081
  6.878  6.798  8.766  12.24  7.090  7.112  4.341  7.017  8.983  6.339
  10.29  9.591  8.115  8.458  7.004  7.003  7.359  4.157  7.186  8.534
  7.075  2.982  7.492  9.381  8.235  7.841  9.526  6.836  5.445  11.21
  5.460  5.911  7.012  6.658  7.499  5.411  6.514  6.125  7.768  9.705
  10.33  6.616  5.381  7.791  6.742  6.912  6.341  7.238  5.816  7.894
  11.13  8.601  9.162  10.37  9.871  9.339  8.461  7.059  7.186  6.518
  7.634  7.500  4.648  6.641  4.999  8.115  9.105  7.810  5.429  6.528
  4.807  9.475  9.667  6.152  9.937  5.068  8.526  5.543  7.917  9.198
  5.355  8.055  8.197  10.37  7.133  9.904  5.449  7.369  11.43  7.655

Size = 3200 Mat. Mult. Elapsed Time: 685.7656 seconds.

*******************************************/